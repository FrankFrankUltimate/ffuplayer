<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Material Icons for the Settings Menu -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        /* Pulling fonts from GitHub Repo via jsDelivr */
        @font-face {
            font-family: 'FrankFrankUltimate Gothic';
            src: url('https://cdn.jsdelivr.net/gh/FrankFrankUltimate/ffuplayer@main/fonts/FrankFrankUltimateGothic-Book.ttf') format('truetype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }
        @font-face {
            font-family: 'FrankFrankUltimate Gothic';
            src: url('https://cdn.jsdelivr.net/gh/FrankFrankUltimate/ffuplayer@main/fonts/FrankFrankUltimateGothic-Demibold.ttf') format('truetype');
            font-weight: 600;
            font-style: normal;
            font-display: swap;
        }

        :root {
            --foreground: #ffffff;
            --pill-bg: rgba(0, 0, 0, 0.7);
            --icon-size: 24px;
            --pill-size: 40px;
            --font-main: 'FrankFrankUltimate Gothic', Verdana, Tahoma, sans-serif;
            --font-bold: 'FrankFrankUltimate Gothic', Verdana, Tahoma, sans-serif;
            --accent: #f0f0f0;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: #000;
            overflow: hidden;
            font-family: var(--font-main);
            color: var(--foreground);
            -webkit-font-smoothing: antialiased;
        }

        .player-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            user-select: none;
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .ui-layer {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 24px;
            opacity: 0;
            transition: opacity 0.3s ease;
            background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 25%, transparent 85%, rgba(0,0,0,0.5) 100%);
            z-index: 10;
        }

        .player-container:hover .ui-layer,
        .ui-layer.active {
            opacity: 1;
        }

        .video-title {
            font-family: var(--font-bold);
            font-weight: 600;
            font-size: 1.25rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            text-transform: lowercase;
        }

        .bottom-controls {
            display: flex;
            flex-direction: column;
            gap: 16px;
            position: relative;
        }

        .settings-menu {
            position: absolute;
            bottom: 60px;
            right: 0;
            width: 280px;
            background: var(--pill-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 8px 0;
            display: none;
            flex-direction: column;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 20;
        }

        .settings-menu.open {
            display: flex;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 10px 16px;
            cursor: pointer;
            transition: background 0.2s;
            gap: 12px;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .menu-item .material-icons {
            font-size: 20px;
            color: var(--accent);
        }

        .menu-item-text {
            flex-grow: 1;
            font-size: 0.95rem;
        }

        .menu-item-value {
            font-size: 0.85rem;
            opacity: 0.6;
        }

        .menu-footer {
            margin-top: 8px;
            padding: 12px 16px;
            border-top: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }

        .version-text {
            font-weight: 600;
            font-size: 0.8rem;
            display: block;
            margin-bottom: 2px;
        }

        .disclaimer-text {
            font-size: 0.65rem;
            opacity: 0.5;
            line-height: 1.2;
            display: block;
        }

        .progress-area {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            position: relative;
            display: flex;
            align-items: center;
            transition: height 0.1s ease;
        }

        .progress-area:hover, .progress-area.dragging {
            height: 6px;
        }

        .progress-bar {
            height: 100%;
            background: var(--foreground);
            width: 0%;
            position: relative;
        }

        .scrubber-dot {
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%) scale(0);
            width: 12px;
            height: 12px;
            background: var(--foreground);
            border-radius: 50%;
            transition: transform 0.1s ease;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        .progress-area:hover .scrubber-dot,
        .progress-area.dragging .scrubber-dot {
            transform: translateY(-50%) scale(1);
        }

        .controls-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .left-controls, .right-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-pill {
            display: flex;
            align-items: center;
            justify-content: center;
            height: var(--pill-size);
            min-width: var(--pill-size);
            background: var(--pill-bg);
            border-radius: 20px; 
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 0;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .control-pill.wide {
            padding: 0 16px;
            width: auto;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            width: var(--pill-size);
            height: var(--pill-size);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            transition: transform 0.1s ease;
        }

        .icon-btn:active {
            transform: scale(0.9);
        }

        .icon-btn img {
            width: var(--icon-size);
            height: var(--icon-size);
            display: block;
        }

        .time-display {
            font-size: 0.85rem;
            white-space: nowrap;
            user-select: none;
            font-variant-numeric: tabular-nums;
            font-weight: 400;
        }

        .volume-container {
            display: flex;
            align-items: center;
            height: 100%;
        }

        .volume-slider-wrapper {
            width: 0;
            overflow: hidden;
            transition: width 0.2s ease, margin 0.2s ease;
            display: flex;
            align-items: center;
        }

        .volume-pill:hover .volume-slider-wrapper {
            width: 70px;
            margin-right: 14px;
        }

        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            background: transparent;
            cursor: pointer;
        }

        input[type="range"]::-webkit-slider-runnable-track {
            height: 2px;
            background: rgba(255, 255, 255, 0.4);
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 10px;
            width: 10px;
            border-radius: 50%;
            background: var(--foreground);
            margin-top: -4px;
            box-shadow: 0 0 2px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>

<div class="player-container" id="playerContainer">
    <video id="mainVideo" src="" playsinline></video>

    <div class="ui-layer" id="uiLayer">
        <div class="top-bar">
            <span class="video-title">example</span>
        </div>

        <div class="bottom-controls">
            <!-- Settings Menu -->
            <div class="settings-menu" id="settingsMenu">
                <div class="menu-item" id="speedOption">
                    <span class="material-icons">slow_motion_video</span>
                    <span class="menu-item-text">Playback Speed</span>
                    <span class="menu-item-value" id="currentSpeedText">Normal</span>
                </div>
                <div class="menu-item" id="captionOption">
                    <span class="material-icons">closed_caption</span>
                    <span class="menu-item-text">Captions</span>
                    <span class="menu-item-value" id="currentCaptionText">Off</span>
                </div>
                <div class="menu-footer">
                    <span class="version-text">FFU Player 1.0</span>
                    <span class="disclaimer-text">This player, despite the styling, is not associated with YouTube.</span>
                </div>
            </div>

            <div class="progress-area" id="progressArea">
                <div class="progress-bar" id="progressBar">
                    <div class="scrubber-dot"></div>
                </div>
            </div>

            <div class="controls-row">
                <div class="left-controls">
                    <div class="control-pill">
                        <button class="icon-btn" id="playPauseBtn">
                            <img id="playPauseIcon" src="" alt="Play">
                        </button>
                    </div>

                    <div class="control-pill volume-pill">
                        <div class="volume-container">
                            <button class="icon-btn" id="muteBtn">
                                <img id="volumeIcon" src="" alt="Volume">
                            </button>
                            <div class="volume-slider-wrapper">
                                <input type="range" id="volumeSlider" min="0" max="1" step="0.05" value="1">
                            </div>
                        </div>
                    </div>

                    <div class="control-pill wide">
                        <div class="time-display">
                            <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                        </div>
                    </div>
                </div>

                <div class="right-controls">
                    <div class="control-pill wide" style="gap: 12px;">
                        <button class="icon-btn" id="settingsBtn">
                            <img id="settingsIcon" src="" alt="Settings">
                        </button>
                        <button class="icon-btn" id="fullscreenBtn">
                            <img id="fullscreenIcon" src="" alt="Fullscreen">
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const video = document.getElementById('mainVideo');
    const playerContainer = document.getElementById('playerContainer');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const playPauseIcon = document.getElementById('playPauseIcon');
    const muteBtn = document.getElementById('muteBtn');
    const volumeIcon = document.getElementById('volumeIcon');
    const volumeSlider = document.getElementById('volumeSlider');
    const progressArea = document.getElementById('progressArea');
    const progressBar = document.getElementById('progressBar');
    const currentTimeEl = document.getElementById('currentTime');
    const durationEl = document.getElementById('duration');
    const fullscreenBtn = document.getElementById('fullscreenBtn');
    const uiLayer = document.getElementById('uiLayer');
    
    // Icons from the Repo
    const settingsIcon = document.getElementById('settingsIcon');
    const fullscreenIcon = document.getElementById('fullscreenIcon');

    // Settings elements
    const settingsBtn = document.getElementById('settingsBtn');
    const settingsMenu = document.getElementById('settingsMenu');
    const speedOption = document.getElementById('speedOption');
    const currentSpeedText = document.getElementById('currentSpeedText');
    const captionOption = document.getElementById('captionOption');
    const currentCaptionText = document.getElementById('currentCaptionText');

    // Updated to pull from FrankFrankUltimate/ffuplayer repo
    const REPO_URL = 'https://cdn.jsdelivr.net/gh/FrankFrankUltimate/ffuplayer@main/player%20control%20icons/';
    const ICONS = {
        play: REPO_URL + 'Play%20and%20Pause%20Icons/play.svg',
        pause: REPO_URL + 'Play%20and%20Pause%20Icons/pause.svg',
        volDown: REPO_URL + 'Volume%20Icons/volume-down.svg',
        volMax: REPO_URL + 'Volume%20Icons/volume-max.svg',
        volOff: REPO_URL + 'Volume%20Icons/volume-off.svg',
        settings: REPO_URL + 'Misc/settings.svg',
        fullscreen: REPO_URL + 'Misc/full-screen.svg'
    };

    // Initial Icon Set
    playPauseIcon.src = ICONS.play;
    volumeIcon.src = ICONS.volMax;
    settingsIcon.src = ICONS.settings;
    fullscreenIcon.src = ICONS.fullscreen;

    let isDraggingScrubber = false;

    function togglePlay() {
        if (video.paused) {
            video.play();
            playPauseIcon.src = ICONS.pause;
        } else {
            video.pause();
            playPauseIcon.src = ICONS.play;
        }
        showUI();
    }

    playPauseBtn.addEventListener('click', togglePlay);
    video.addEventListener('click', (e) => {
        if (e.target === video) {
            settingsMenu.classList.remove('open');
            togglePlay();
        }
    });

    window.addEventListener('keydown', (e) => {
        const key = e.key.toLowerCase();
        if (key === ' ' || key === 'k') {
            e.preventDefault();
            togglePlay();
        }
    });

    // Settings Toggle
    settingsBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        settingsMenu.classList.toggle('open');
        showUI();
    });

    // Speed Cycle Logic
    const speeds = [0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2];
    let currentSpeedIndex = 3; // 1x

    speedOption.addEventListener('click', (e) => {
        e.stopPropagation();
        currentSpeedIndex = (currentSpeedIndex + 1) % speeds.length;
        const newSpeed = speeds[currentSpeedIndex];
        video.playbackRate = newSpeed;
        currentSpeedText.innerText = newSpeed === 1 ? 'Normal' : newSpeed + 'x';
    });

    // Captions Toggle
    let captionsOn = false;
    captionOption.addEventListener('click', (e) => {
        e.stopPropagation();
        captionsOn = !captionsOn;
        currentCaptionText.innerText = captionsOn ? 'On' : 'Off';
    });

    document.addEventListener('click', () => {
        settingsMenu.classList.remove('open');
    });

    function updateVolumeIcon(val) {
        if (val == 0 || video.muted) {
            volumeIcon.src = ICONS.volOff;
        } else if (val >= 0.75) {
            volumeIcon.src = ICONS.volMax;
        } else {
            volumeIcon.src = ICONS.volDown;
        }
    }

    volumeSlider.addEventListener('input', (e) => {
        const val = parseFloat(e.target.value);
        video.volume = val;
        video.muted = false;
        updateVolumeIcon(val);
    });

    muteBtn.addEventListener('click', () => {
        video.muted = !video.muted;
        updateVolumeIcon(video.muted ? 0 : video.volume);
    });

    video.addEventListener('timeupdate', () => {
        if (!isDraggingScrubber) {
            const percent = (video.currentTime / video.duration) * 100;
            progressBar.style.width = `${percent}%`;
            currentTimeEl.innerText = formatTime(video.currentTime);
        }
    });

    video.addEventListener('loadedmetadata', () => {
        durationEl.innerText = formatTime(video.duration);
    });

    function scrub(e) {
        const rect = progressArea.getBoundingClientRect();
        let pos = (e.pageX - rect.left) / rect.width;
        pos = Math.max(0, Math.min(1, pos));
        progressBar.style.width = `${pos * 100}%`;
        currentTimeEl.innerText = formatTime(pos * video.duration);
        return pos;
    }

    progressArea.addEventListener('mousedown', (e) => {
        isDraggingScrubber = true;
        progressArea.classList.add('dragging');
        const pos = scrub(e);
        video.currentTime = pos * video.duration;
    });

    window.addEventListener('mousemove', (e) => {
        if (isDraggingScrubber) scrub(e);
    });

    window.addEventListener('mouseup', (e) => {
        if (isDraggingScrubber) {
            const pos = scrub(e);
            video.currentTime = pos * video.duration;
            isDraggingScrubber = false;
            progressArea.classList.remove('dragging');
        }
    });

    function formatTime(time) {
        if (isNaN(time)) return "0:00";
        const minutes = Math.floor(time / 60);
        const seconds = Math.floor(time % 60);
        return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    }

    fullscreenBtn.addEventListener('click', () => {
        if (!document.fullscreenElement) {
            playerContainer.requestFullscreen().catch(err => {
                console.error(`Fullscreen error: ${err.message}`);
            });
        } else {
            document.exitFullscreen();
        }
    });

    let uiTimeout;
    function showUI() {
        uiLayer.classList.add('active');
        clearTimeout(uiTimeout);
        if ((!video.paused || isDraggingScrubber) && !settingsMenu.classList.contains('open')) {
            uiTimeout = setTimeout(() => {
                if (!isDraggingScrubber && !settingsMenu.classList.contains('open')) {
                    uiLayer.classList.remove('active');
                }
            }, 3000);
        }
    }

    playerContainer.addEventListener('mousemove', showUI);
    video.addEventListener('play', showUI);
</script>
</body>
</html>
